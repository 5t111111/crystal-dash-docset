<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta charset="utf-8"/>
  <meta id="repository-name" content="github.com/crystal-lang/crystal"/>
  <link href="../css/style.css" rel="stylesheet" type="text/css"/>
  
  <a class="dashingAutolink" name="autolink-782"></a><a class="dashAnchor" name="//apple_ref/cpp/Class/Crypto%3A%3ABcrypt%20-%20github.com%2Fcrystal-lang%2Fcrystal"></a><title>Crypto::Bcrypt - github.com/crystal-lang/crystal</title>
</head>
<body>



<div id="main-content">
<h1 class="type-name">

  <span class="kind">class</span> Crypto::Bcrypt

</h1>


  <ul class="superclass-hierarchy">
<li class="superclass"><a href="../Crypto/Bcrypt.html">Crypto::Bcrypt</a></li>
<li class="superclass"><a href="../Reference.html">Reference</a></li>
<li class="superclass"><a href="../Object.html">Object</a></li>
</ul>




  <h2>Overview</h2>

  <p>Pure Crystal implementation of the Bcrypt algorithm by Niels Provos and David
Mazi&egrave;res, as <a href="https://www.usenix.org/legacy/events/usenix99/provos/provos_html/index.html" target="_blank">presented at USENIX in
1999</a>.</p>

<p>Refer to <code><a href="../Crypto/Bcrypt.html">Crypto::Bcrypt</a>::Password</code> for a higher level interface.</p>

<p>About the Cost</p>

<p>Bcrypt, like the PBKDF2 or scrypt ciphers, are designed to be slow, so
generating rainbow tables or cracking passwords is nearly impossible. Yet,
computers are always getting faster and faster, so the actual cost must be
incremented every once in a while.
Always use the maximum cost that is tolerable, performance wise, for your
application. Be sure to test and select this based on your server, not your
home computer.</p>

<p>This implementation of Bcrypt is currently 50% slower than pure C solutions,
so keep this in mind when selecting your cost. It may be wise to test with
Ruby&#39;s <a href="https://github.com/codahale/bcrypt-ruby" target="_blank">bcrypt gem</a>
which is a binding to OpenBSD&#39;s implementation.</p>

<p>Last but not least: beware of denial of services! Always protect your
application using an external strategy (eg: rate limiting), otherwise
endpoints that verifies bcrypt hashes will be an easy target.</p>














  <h2>Defined in:</h2>
  
    
      <a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L28" target="_blank">crypto/bcrypt.cr</a>
    
    <br/>
  



  
    <h2>Constant Summary</h2>
  
  <dl>
    
      <dt class="entry-const" id="COST_RANGE">
        <strong>COST_RANGE</strong> = <code><span class="n">4</span>..<span class="n">31</span></code>
      </dt>
      
    
      <dt class="entry-const" id="DEFAULT_COST">
        <strong>DEFAULT_COST</strong> = <code><span class="n">11</span></code>
      </dt>
      
    
      <dt class="entry-const" id="PASSWORD_RANGE">
        <strong>PASSWORD_RANGE</strong> = <code><span class="n">1</span>..<span class="n">51</span></code>
      </dt>
      
    
      <dt class="entry-const" id="SALT_SIZE">
        <strong>SALT_SIZE</strong> = <code><span class="n">16</span></code>
      </dt>
      
    
  </dl>



  <h2>Constructors</h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#new%28password%3AString%2Csalt%3AString%2Ccost%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : String, salt : String, cost = <span class="t">DEFAULT_COST</span>)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#new%28password%3ABytes%2Csalt%3ABytes%2Ccost%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : Bytes, salt : Bytes, cost = <span class="t">DEFAULT_COST</span>)</a>
        
      </li>
    
  </ul>



  <h2>Class Method Summary</h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#hash_secret%28password%2Ccost%3DDEFAULT_COST%29%3AString-class-method" class="signature"><strong>.hash_secret</strong>(password, cost = <span class="t">DEFAULT_COST</span>) : String</a>
        
      </li>
    
  </ul>



  <h2>Instance Method Summary</h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#cost%3AInt32-instance-method" class="signature"><strong>#cost</strong> : Int32</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#digest-instance-method" class="signature"><strong>#digest</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#inspect%28io%29-instance-method" class="signature"><strong>#inspect</strong>(io)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#password%3ABytes-instance-method" class="signature"><strong>#password</strong> : Bytes</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#salt%3ABytes-instance-method" class="signature"><strong>#salt</strong> : Bytes</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#to_s%28io%29-instance-method" class="signature"><strong>#to_s</strong>(io)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#to_s-instance-method" class="signature"><strong>#to_s</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%2C%26block%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options, &amp;block)</a>
        
      </li>
    
  </ul>





<div class="methods-inherited">
  
    

  <h3>Instance methods inherited from class <code><a href="../Reference.html">Reference</a></code>
</h3>
  
  
    <a href="../Reference.html#%3D%3D%28other%3Aself%29-instance-method" class="tooltip">
      <span>==(other : self)<br/>==(other)</span>
    ==</a>, 
    
  
    <a href="../Reference.html#dup-instance-method" class="tooltip">
      <span>dup</span>
    dup</a>, 
    
  
    <a href="../Reference.html#hash%28hasher%29-instance-method" class="tooltip">
      <span>hash(hasher)</span>
    hash</a>, 
    
  
    <a href="../Reference.html#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip">
      <span>inspect(io : IO) : Nil</span>
    inspect</a>, 
    
  
    <a href="../Reference.html#object_id%3AUInt64-instance-method" class="tooltip">
      <span>object_id : UInt64</span>
    object_id</a>, 
    
  
    <a href="../Reference.html#pretty_print%28pp%29%3ANil-instance-method" class="tooltip">
      <span>pretty_print(pp) : Nil</span>
    pretty_print</a>, 
    
  
    <a href="../Reference.html#same%3F%28other%3AReference%29-instance-method" class="tooltip">
      <span>same?(other : Reference)<br/>same?(other : Nil)</span>
    same?</a>, 
    
  
    <a href="../Reference.html#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip">
      <span>to_s(io : IO) : Nil</span>
    to_s</a>
    
  


    

  <h3>Constructor methods inherited from class <code><a href="../Reference.html">Reference</a></code>
</h3>
  
  
    <a href="../Reference.html#new-class-method" class="tooltip">
      <span>new</span>
    new</a>
    
  


    


  
    

  <h3>Instance methods inherited from class <code><a href="../Object.html">Object</a></code>
</h3>
  
  
    <a href="../Object.html#%21%3D%28other%29-instance-method" class="tooltip">
      <span>!=(other)</span>
    !=</a>, 
    
  
    <a href="../Object.html#%21~%28other%29-instance-method" class="tooltip">
      <span>!~(other)</span>
    !~</a>, 
    
  
    <a href="../Object.html#%3D%3D%28other%29-instance-method" class="tooltip">
      <span>==(other)</span>
    ==</a>, 
    
  
    <a href="../Object.html#%3D%3D%3D%28other%3AJSON%3A%3AAny%29-instance-method" class="tooltip">
      <span>===(other : JSON::Any)<br/>===(other : YAML::Any)<br/>===(other)</span>
    ===</a>, 
    
  
    <a href="../Object.html#%3D~%28other%29-instance-method" class="tooltip">
      <span>=~(other)</span>
    =~</a>, 
    
  
    <a href="../Object.html#class-instance-method" class="tooltip">
      <span>class</span>
    class</a>, 
    
  
    <a href="../Object.html#dup-instance-method" class="tooltip">
      <span>dup</span>
    dup</a>, 
    
  
    <a href="../Object.html#hash%28hasher%29-instance-method" class="tooltip">
      <span>hash(hasher)<br/>hash</span>
    hash</a>, 
    
  
    <a href="../Object.html#inspect%28io%3AIO%29-instance-method" class="tooltip">
      <span>inspect(io : IO)<br/>inspect</span>
    inspect</a>, 
    
  
    <a href="../Object.html#itself-instance-method" class="tooltip">
      <span>itself</span>
    itself</a>, 
    
  
    <a href="../Object.html#not_nil%21-instance-method" class="tooltip">
      <span>not_nil!</span>
    not_nil!</a>, 
    
  
    <a href="../Object.html#pretty_inspect%28width%3D79%2Cnewline%3D%26quot%3B%5Cn%26quot%3B%2Cindent%3D0%29%3AString-instance-method" class="tooltip">
      <span>pretty_inspect(width = <span class="n">79</span>, newline = <span class="s">&#34;\n&#34;</span>, indent = <span class="n">0</span>) : String</span>
    pretty_inspect</a>, 
    
  
    <a href="../Object.html#pretty_print%28pp%3APrettyPrint%29%3ANil-instance-method" class="tooltip">
      <span>pretty_print(pp : PrettyPrint) : Nil</span>
    pretty_print</a>, 
    
  
    <a href="../Object.html#tap%28%26block%29-instance-method" class="tooltip">
      <span>tap(&amp;block)</span>
    tap</a>, 
    
  
    <a href="../Object.html#to_json%28io%3AIO%29-instance-method" class="tooltip">
      <span>to_json(io : IO)<br/>to_json</span>
    to_json</a>, 
    
  
    <a href="../Object.html#to_pretty_json%28indent%3AString%3D%26quot%3B%26quot%3B%29-instance-method" class="tooltip">
      <span>to_pretty_json(indent : String = <span class="s">&#34;  &#34;</span>)<br/>to_pretty_json(io : IO, indent : String = <span class="s">&#34;  &#34;</span>)</span>
    to_pretty_json</a>, 
    
  
    <a href="../Object.html#to_s-instance-method" class="tooltip">
      <span>to_s<br/>to_s(io : IO)</span>
    to_s</a>, 
    
  
    <a href="../Object.html#to_yaml%28io%3AIO%29-instance-method" class="tooltip">
      <span>to_yaml(io : IO)<br/>to_yaml</span>
    to_yaml</a>, 
    
  
    <a href="../Object.html#try%28%26block%29-instance-method" class="tooltip">
      <span>try(&amp;block)</span>
    try</a>, 
    
  
    <a href="../Object.html#unsafe_as%28type%3AT.class%29forallT-instance-method" class="tooltip">
      <span>unsafe_as(type : T.class) forall T</span>
    unsafe_as</a>
    
  


    

  <h3>Constructor methods inherited from class <code><a href="../Object.html">Object</a></code>
</h3>
  
  
    <a href="../Object.html#from_json%28string_or_io%2Croot%3AString%29%3Aself-class-method" class="tooltip">
      <span>from_json(string_or_io, root : String) : self<br/>from_json(string_or_io) : self</span>
    from_json</a>, 
    
  
    <a href="../Object.html#from_yaml%28string_or_io%3AString%7CIO%29%3Aself-class-method" class="tooltip">
      <span>from_yaml(string_or_io : String | IO) : self</span>
    from_yaml</a>
    
  


    


  
</div>


  <h2>Constructor Detail</h2>
  
    <div class="entry-detail" id="new(password:String,salt:String,cost=DEFAULT_COST)-class-method">
      <a class="dashingAutolink" name="autolink-783"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20self.new%28password%20%3A%20String%2C%20salt%20%3A%20String%2C%20cost%20%3D%20DEFAULT_COST%29"></a><div class="signature">
        
        def self.<strong>new</strong>(password : <a href="../String.html">String</a>, salt : <a href="../String.html">String</a>, cost = <span class="t">DEFAULT_COST</span>)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L53" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="new(password:Bytes,salt:Bytes,cost=DEFAULT_COST)-class-method">
      <a class="dashingAutolink" name="autolink-784"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20self.new%28password%20%3A%20Bytes%2C%20salt%20%3A%20Bytes%2C%20cost%20%3D%20DEFAULT_COST%29"></a><div class="signature">
        
        def self.<strong>new</strong>(password : <a href="../Bytes.html">Bytes</a>, salt : <a href="../Bytes.html">Bytes</a>, cost = <span class="t">DEFAULT_COST</span>)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L64" target="_blank">View source</a>]
        
      </div>
    </div>
  



  <h2>Class Method Detail</h2>
  
    <div class="entry-detail" id="hash_secret(password,cost=DEFAULT_COST):String-class-method">
      <a class="dashingAutolink" name="autolink-785"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20self.hash_secret%28password%2C%20cost%20%3D%20DEFAULT_COST%29%20%3A%20String"></a><div class="signature">
        
        def self.<strong>hash_secret</strong>(password, cost = <span class="t">DEFAULT_COST</span>) : <a href="../String.html">String</a>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L46" target="_blank">View source</a>]
        
      </div>
    </div>
  



  <h2>Instance Method Detail</h2>
  
    <div class="entry-detail" id="cost:Int32-instance-method">
      <a class="dashingAutolink" name="autolink-786"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20cost%20%3A%20Int32"></a><div class="signature">
        
        def <strong>cost</strong> : <a href="../Int32.html">Int32</a>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L62" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="digest-instance-method">
      <a class="dashingAutolink" name="autolink-787"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20digest"></a><div class="signature">
        
        def <strong>digest</strong>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L72" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="inspect(io)-instance-method">
      <a class="dashingAutolink" name="autolink-788"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20inspect%28io%29"></a><div class="signature">
        
        def <strong>inspect</strong>(io)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="password:Bytes-instance-method">
      <a class="dashingAutolink" name="autolink-789"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20password%20%3A%20Bytes"></a><div class="signature">
        
        def <strong>password</strong> : <a href="../Bytes.html">Bytes</a>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L60" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="salt:Bytes-instance-method">
      <a class="dashingAutolink" name="autolink-790"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20salt%20%3A%20Bytes"></a><div class="signature">
        
        def <strong>salt</strong> : <a href="../Bytes.html">Bytes</a>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L61" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="to_s(io)-instance-method">
      <a class="dashingAutolink" name="autolink-791"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20to_s%28io%29"></a><div class="signature">
        
        def <strong>to_s</strong>(io)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L86" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="to_s-instance-method">
      <a class="dashingAutolink" name="autolink-792"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20to_s"></a><div class="signature">
        
        def <strong>to_s</strong>

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L78" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="to_slice(*args,**options)-instance-method">
      <a class="dashingAutolink" name="autolink-793"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20to_slice%28%2Aargs%2C%20%2A%2Aoptions%29"></a><div class="signature">
        
        def <strong>to_slice</strong>(*args, **options)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L94" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="to_slice(*args,**options,&amp;block)-instance-method">
      <a class="dashingAutolink" name="autolink-794"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/def%20to_slice%28%2Aargs%2C%20%2A%2Aoptions%2C%20%26block%29"></a><div class="signature">
        
        def <strong>to_slice</strong>(*args, **options, &amp;block)

        
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/crystal-lang/crystal/blob/4f9ed8d03208dd0db33993c5a6fa6753bc1cf91e/src/crypto/bcrypt.cr#L94" target="_blank">View source</a>]
        
      </div>
    </div>
  




</div>



</body></html>